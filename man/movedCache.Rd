% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/DBI.R
\name{movedCache}
\alias{movedCache}
\title{Deal with moved cache issues}
\usage{
movedCache(
  new,
  old,
  drv = getOption("reproducible.drv", RSQLite::SQLite()),
  conn = getOption("reproducible.conn", NULL)
)
}
\arguments{
\item{new}{Either the path of the new \code{cachePath} where the cache was moved or copied to, or
the new DB Table Name}

\item{old}{Optional, if there is only one table in the \code{new} cache path.
Either the path of the previous \code{cachePath} where the cache was moved or copied from, or
the old DB Table Name}

\item{drv}{an object that inherits from \linkS4class{DBIDriver},
or an existing \linkS4class{DBIConnection}
object (in order to clone an existing connection).}

\item{conn}{A \linkS4class{DBIConnection} object, as returned by
\code{\link[DBI:dbConnect]{dbConnect()}}.}
}
\description{
If a user manually copies a complete Cache folder (including the db file and rasters folder),
there are issues that must be addressed. Primarily, the db table must be renamed. Run
this function after a manual copy of a cache folder. See examples for one way to do that.
}
\examples{
tmpCache <- normalizePath(file.path(tempdir(), "tmpCache"), mustWork = FALSE)
tmpdir <- normalizePath(file.path(tempdir(), "tmpdir"), mustWork = FALSE)
bb <- Cache(rnorm, 1, cacheRepo = tmpCache)

# Copy all files from tmpCache to tmpdir
froms <- normalizePath(dir(tmpCache, recursive = TRUE, full.names = TRUE),
                       mustWork = FALSE)
dir.create(file.path(tmpdir, "rasters"), recursive = TRUE)
dir.create(file.path(tmpdir, "cacheOutputs"), recursive = TRUE)
file.copy(from = froms, overwrite = TRUE,
          to = gsub(tmpCache, tmpdir, froms))

# Must use 'movedCache' to update the database table
movedCache(new = tmpdir, old = tmpCache)
bb <- Cache(rnorm, 1, cacheRepo = tmpdir) # should recover the previous call

}
